vcpkg_check_linkage(ONLY_STATIC_LIBRARY)

vcpkg_from_github(
    OUT_SOURCE_PATH SOURCE_PATH
    REPO TerensTare/modern_bloom
    REF "4e5dd1f7124f3dd0142733bf410c4f8c81301921"
    SHA512 ea882232ca8d66b581b0e7b2b36787af4269e03534860af8d0c96d531e8b6d85573ee21f6a3ca6678f9185a87a31f4af7846b3069758de5e6f4edf5c816d8d07
    HEAD_REF main
)

vcpkg_cmake_configure(
    SOURCE_PATH "${SOURCE_PATH}"
    OPTIONS
    -DMB_BUILD_DOCS=OFF
    # -DMB_BUILD_TESTS=OFF
    MAYBE_UNUSED_VARIABLES
    CMAKE_INSTALL_BINDIR
    CMAKE_INSTALL_LIBDIR
    FETCHCONTENT_FULLY_DISCONNECTED
    MB_BUILD_DOCS
    MB_BUILD_TESTS
    _VCPKG_ROOT_DIR
)

vcpkg_cmake_install()
vcpkg_cmake_config_fixup(PACKAGE_NAME "modern_bloom")

file(REMOVE_RECURSE "${CURRENT_PACKAGES_DIR}/lib")

file(INSTALL "${SOURCE_PATH}/LICENSE" DESTINATION "${CURRENT_PACKAGES_DIR}/share/${PORT}" RENAME copyright)
configure_file("${CMAKE_CURRENT_LIST_DIR}/usage" "${CURRENT_PACKAGES_DIR}/share/${PORT}/usage" COPYONLY)